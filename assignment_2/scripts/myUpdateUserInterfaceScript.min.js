$(document).ready(function(){function a(){$.ajax({type:"GET",url:"php/db/get-by-views.php",cache:!1,success:g,error:function(a,b,c){console.log(a.status),console.log(c)}})}function b(a){$.ajax({type:"POST",url:"php/db/get-by-search.php",data:{search:a},cache:!1,success:g,error:function(a,b,c){console.log(a.status),console.log(c)}})}function c(a){$.ajax({type:"POST",url:"php/db/get-by-type.php",data:{feedName:a},cache:!1,success:g,error:function(a,b,c){console.log(a.status),console.log(c)}})}function d(a){$.ajax({type:"POST",url:"php/get_news_item_article.php",data:{link:a},cache:!1,success:i,error:function(a,b,c){console.log(a.status),console.log(c)}})}function e(a){$.ajax({type:"POST",url:"php/db/get-by-link.php",data:{link:a},cache:!1,success:j,error:function(a,b,c){console.log(a.status),console.log(c)}})}function f(d){if(window.scrollTo(0,0),0===d.toLowerCase().indexOf("most popular"))a(),$("#search-box").val("");else if(0===d.indexOf("search")){var e=d.split("search=")[1].split("+modal=")[0];$("#search-box").val(e),b(e)}else{var f=d.split("+modal=")[0];c(f),$("#search-box").val("")}var g=$("li");g.removeClass("active");for(var h=0;h<g.length;h++)g.get(h).getElementsByTagName("a")[0].innerText.toLowerCase()===d.toLowerCase()&&$(g.get(h)).addClass("active")}function g(a){var b=$(a).find("Item");if($("#news-feed").empty(),amountOfNewsItems=b.length,0===amountOfNewsItems)$("#news-feed").append("<h2>No search result found for '"+$("#search-box").val()+"' :(</h2>");else{$("#search-box").val().length>0&&$("#news-feed").append("<h2>Search results for '"+$("#search-box").val()+"'.</h2>"),$("#news-feed").append('<div class="panel-group">');for(var c=0;c<amountOfNewsItems;c++){var d=b[c].getElementsByTagName("Title")[0].innerHTML,e=b[c].getElementsByTagName("Description")[0].innerHTML,f=b[c].getElementsByTagName("Image_Source")[0].innerHTML,g=b[c].getElementsByTagName("News_Link")[0].innerHTML,i=b[c].getElementsByTagName("Views")[0].innerHTML,j="";"undefined"!==f&&(j='<img class="news-image"src="'+f+'" alt="" class="img"/>'),$("#news-feed").append('<div class="col-sm-6 col-lg-3"><div class="panel panel-default " value="'+g+'"><div class="panel-heading"><label class="news-title">'+d+"</label></div>"+j+'<div class="panel-body"><p>'+e+"</p><label>Views:</label><span> "+i+"</span></div></div></div>")}$("#news-feed").append("</div"),$(".news-image:eq(0)").on("load",function(){$(".panel").matchHeight(!1)}),$(".panel").click(function(){var a=$(this).attr("value");history.pushState(null,null,"news_site.html?"+location.hash+"+modal="+a),h(a)})}}function h(a){k(),d(a),e(a)}function i(a){desc=$(a).find(".story-body__inner p"),0===desc.length&&(desc=$(a).find(".map-body p")),0===desc.length&&(desc=$(a).find("#story-body p")),0===desc.length&&(desc=$(a).find(".main_article_text p")),desc.each(function(){$("#modal-description").append($(this)[0].outerHTML),$("#modal-description").append("<br>")})}function j(a){var b=$(a).find("Item").eq(0),c=b.find("Image_Source").text();$("#modal-title").html(b.find("Title").text()),$("#modal-views").html(" "+b.find("Views").text()),$("#modal-pubDate").html(" "+b.find("Publish_Date").text()),$("#modal-channel").html(" "+b.find("Channels")[0].innerHTML),$("#modal-link").attr("href",b.find("News_Link")[0].innerHTML),"undefined"===c?image="":image='<img src="'+c+'" alt="" class="img"/>',$("#modal-picture").attr("src",c),$(".modal").modal("toggle")}function k(){$("#modal-title").html(""),$("#modal-description").html(""),$("#modal-views").html(" "),$("#modal-pubDate").html(" "),$("#modal-channel").html(" "),$("#modal-picture").attr("src","")}function l(){var a=location.hash.split("#").pop(),b=a.split("+modal=");""===b[0]&&(a="home",2===b.length&&(a+="+modal="+b[1])),f(a),a.indexOf("+modal=")!==-1?h(a.split("+modal=")[1]):$("#modal").modal("hide")}l(),$('[data-toggle="tooltip"]').tooltip(),$(window).on("popstate",function(){l()}),$("#modal").on("hidden.bs.modal",function(){var a="news_site.html?"+location.hash.split("+modal=")[0];history.pushState(null,null,a)}),$("li").click(function(){var a=$(this).get(0).getElementsByTagName("a")[0].innerText;history.pushState(null,"News - "+a,"news_site.html?#"+a.toLocaleLowerCase()),f(a)}),$("#search-box").bind("input",function(){history.pushState(null,null,"news_site.html?#search="+$(this).val()),$(".nav.navbar-nav li").removeClass("active"),b($(this).val())})});
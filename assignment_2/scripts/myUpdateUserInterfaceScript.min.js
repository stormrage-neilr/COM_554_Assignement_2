$(document).ready(function(){function e(){$.ajax({type:"GET",url:"php/db/get-by-views.php",cache:!1,success:o,error:function(e,a,t){console.log(e.status),console.log(t)}})}function a(e){$.ajax({type:"GET",url:"php/db/get-by-search.php",data:{search:e},cache:!1,success:o,error:function(e,a,t){console.log(e.status),console.log(t)}})}function t(e){$.ajax({type:"GET",url:"php/db/get-by-type.php",data:{feedName:e},cache:!1,success:o,error:function(e,a,t){console.log(e.status),console.log(t)}})}function n(e){$.ajax({type:"GET",url:"php/get_news_item_article.php",data:{link:e},cache:!1,success:c,error:function(e,a,t){console.log(e.status),console.log(t)}})}function l(e){$.ajax({type:"GET",url:"php/db/get-by-link.php",data:{link:e},cache:!1,success:d,error:function(e,a,t){console.log(e.status),console.log(t)}})}function s(n){if(window.scrollTo(0,0),0===n.toLowerCase().indexOf("most popular"))e(),$("#search-box").val("");else if(0===n.indexOf("search")){var l=n.split("search=")[1].split("+modal=")[0];$("#search-box").val(l),a(l)}else{var s=n.split("+modal=")[0];t(s),$("#search-box").val("")}var o=$("li");o.removeClass("active");for(var i=0;i<o.length;i++)o.get(i).getElementsByTagName("a")[0].innerText.toLowerCase()===n.toLowerCase()&&$(o.get(i)).addClass("active")}function o(e){var a=$(e).find("Item");if($("#news-feed").empty(),amountOfNewsItems=a.length,0===amountOfNewsItems)$("#news-feed").append("<h2>No search result found for '"+$("#search-box").val()+"' :(</h2>");else{$("#search-box").val().length>0&&$("#news-feed").append("<h2>Search result found for '"+$("#search-box").val()+"'.</h2>"),$("#news-feed").append('<div class="panel-group">');for(var t=0;t<amountOfNewsItems;t++){var n=a[t].getElementsByTagName("Title")[0].innerHTML,l=a[t].getElementsByTagName("Description")[0].innerHTML,s=a[t].getElementsByTagName("Image_Source")[0].innerHTML,o=a[t].getElementsByTagName("News_Link")[0].innerHTML,c=a[t].getElementsByTagName("Views")[0].innerHTML,d="";"undefined"!==s&&(d='<img class="news-image"src="'+s+'" alt="" class="img"/>'),$("#news-feed").append('<div class="col-sm-6 col-lg-3"><div class="panel panel-default " value="'+o+'"><div class="panel-heading"><label class="news-title">'+n+"</label></div>"+d+'<div class="panel-body"><p>'+l+"</p><label>Views:</label><span> "+c+"</span></div></div></div>")}$("#news-feed").append("</div"),$(".news-image:eq(0)").on("load",function(){$(".panel").matchHeight(!1)}),$(".panel").click(function(){var e=$(this).attr("value");history.pushState(null,null,"news_site.html?"+location.hash+"+modal="+e),i(e)})}}function i(e){r(),n(e),l(e)}function c(e){desc=$(e).find(".story-body__inner p"),0===desc.length&&(desc=$(e).find(".map-body p")),0===desc.length&&(desc=$(e).find("#story-body p")),0===desc.length&&(desc=$(e).find(".main_article_text p")),desc.each(function(){$("#modal-description").append($(this)[0].outerHTML),$("#modal-description").append("<br>")})}function d(e){var a=$(e).find("Item").eq(0),t=a.find("Image_Source").text();$("#modal-title").html(a.find("Title").text()),$("#modal-views").html(" "+a.find("Views").text()),$("#modal-pubDate").html(" "+a.find("Publish_Date").text()),$("#modal-channel").html(" "+a.find("Channels")[0].innerHTML),$("#modal-link").attr("href",a.find("News_Link")[0].innerHTML),"undefined"===t?image="":image='<img src="'+t+'" alt="" class="img"/>',$("#modal-picture").attr("src",t),$(".modal").modal("toggle")}function r(){$("#modal-title").html(""),$("#modal-description").html(""),$("#modal-views").html(" "),$("#modal-pubDate").html(" "),$("#modal-channel").html(" "),$("#modal-picture").attr("src","")}function p(){var e=location.hash.split("#").pop(),a=e.split("+modal=");""===a[0]&&(e="home",2===a.length&&(e+="+modal="+a[1])),s(e),-1!==e.indexOf("+modal=")?i(e.split("+modal=")[1]):$("#modal").modal("hide")}p(),$('[data-toggle="tooltip"]').tooltip(),$(window).on("popstate",function(){p()}),$("#modal").on("hidden.bs.modal",function(){var e="news_site.html?"+location.hash.split("+modal=")[0];history.pushState(null,null,e)}),$("li").click(function(){var e=$(this).get(0).getElementsByTagName("a")[0].innerText;history.pushState(null,"News - "+e,"news_site.html?#"+e.toLocaleLowerCase()),s(e)}),$("#search-box").bind("input",function(){history.pushState(null,null,"news_site.html?#search="+$(this).val()),$(".nav.navbar-nav li").removeClass("active"),a($(this).val())})});